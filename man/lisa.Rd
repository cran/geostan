% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/convenience-functions.R
\name{lisa}
\alias{lisa}
\title{Local Moran's I}
\source{
Anselin, Luc. "Local indicators of spatial associationâ€”LISA." Geographical Analysis 27, no. 2 (1995): 93-115.
}
\usage{
lisa(x, w, type = TRUE)
}
\arguments{
\item{x}{Numeric vector of length \code{n}.}

\item{w}{An \verb{n x n} spatial connectivity matrix. See \link[geostan]{shape2mat}. If \code{w} is not row standardized (\code{all(Matrix::rowSums(w) == 1)}), it will automatically be row-standardized.}

\item{type}{Return the type of association also (High-High, Low-Low, High-Low, and Low-High)? Defaults to \code{FALSE}.}
}
\value{
If \code{type = FALSE} a numeric vector of lisa values for exploratory analysis of local spatial autocorrelation. If \code{type = TRUE}, a \code{data.frame} with columns \code{Li} (the lisa value) and \code{type}.
}
\description{
A local indicator of spatial association (lisa).
}
\details{
The values will be standardized with \code{z = scale(x)} first and \code{w} will be row-standardized if needed. The LISA values are the product of each \code{z} value with their respective mean surrounding value \code{lagz = w \%*\% z}; \code{lisa = z * lagz}. These are for exploratory analysis and model diagnostics. The function uses Equation 7 from Anselin (1995).

An above-average value (i.e. positive z-value) with positive mean spatial lag indicates local positive spatial autocorrelation and is designated type "High-High"; a low value surrounded by high values indicates negative spatial autocorrelation and is designated type "Low-High", and so on.
}
\examples{
library(ggplot2)
library(sf)
data(georgia)
w <- shape2mat(georgia, "W")
x <- georgia$ICE
li = lisa(x, w)
head(li)
ggplot(georgia, aes(fill = li$Li)) +
  geom_sf() +
  scale_fill_gradient2()
}
\seealso{
\code{\link[geostan]{moran_plot}}, \code{\link[geostan]{mc}}, \code{\link[geostan]{aple}}
}
